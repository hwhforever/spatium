<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Tile Component</title>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React and ReactDOM CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel Standalone for JSX transformation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            transition: background 0.3s ease;
            background-color: #111827; /* Default dark background */
        }
        
        /* Theme Backgrounds */
        body.theme-dark { background-color: #111827; }
        body.theme-space { background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%); }
        body.theme-bloomberg { background-color: #000000; }
        body.theme-ocean { background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%); }
        body.theme-forest { background: linear-gradient(135deg, #134e5e 0%, #71b280 100%); }
        
        /* Base tile styles */
        .project-tile {
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3), 0 4px 8px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            position: absolute;
            user-select: none;
        }
        
        .project-tile.dragging {
            transform: rotate(2deg) scale(1.05);
            z-index: 1000;
            opacity: 0.8;
            cursor: grabbing;
            transition: none;
        }
        
        .project-tile:not(.dragging) {
            cursor: grab;
        }
        
        .dashboard-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            /* Optional: Add subtle grid visualization for debugging */
            /* background-image: 
                linear-gradient(to right, rgba(255, 255, 255, 0.05) 1px, transparent 1px),
                linear-gradient(to bottom, rgba(255, 255, 255, 0.05) 1px, transparent 1px);
            background-size: 180px 180px; */
        }
        
        .project-tile::before {
            content: '';
            position: absolute;
            inset: -2px;
            background: transparent;
            border-radius: 24px;
            transition: all 0.3s ease;
            z-index: -1;
        }
        
        .project-tile:hover {
            transform: translateY(-2px);
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3), 0 8px 16px rgba(0, 0, 0, 0.3);
        }
        
        /* Dark Theme */
        body.theme-dark .project-tile {
            background: linear-gradient(135deg, #1f2937 0%, #111827 100%);
        }
        body.theme-dark .project-tile:hover::before {
            background: linear-gradient(45deg, #3b82f6, #1d4ed8, #2563eb, #1e40af);
            background-size: 300% 300%;
            animation: electricBlue 2s ease infinite;
        }
        body.theme-dark .icon-placeholder {
            background: linear-gradient(135deg, #4b5563 0%, #374151 100%);
            border: 2px solid #6b7280;
        }
        
        /* Space Theme */
        body.theme-space .project-tile {
            background: linear-gradient(135deg, #1e1b4b 0%, #312e81 100%);
        }
        body.theme-space .project-tile:hover::before {
            background: linear-gradient(45deg, #8b5cf6, #7c3aed, #6d28d9, #5b21b6);
            background-size: 300% 300%;
            animation: spaceGlow 2s ease infinite;
        }
        body.theme-space .icon-placeholder {
            background: linear-gradient(135deg, #3730a3 0%, #1e1b4b 100%);
            border: 2px solid #6366f1;
        }
        
        /* Bloomberg Theme */
        body.theme-bloomberg .project-tile {
            background: linear-gradient(135deg, #1a1a1a 0%, #000000 100%);
            border: 1px solid #ff6600;
        }
        body.theme-bloomberg .project-tile:hover::before {
            background: linear-gradient(45deg, #ff6600, #ff8533, #ff6600, #cc5200);
            background-size: 300% 300%;
            animation: bloombergPulse 2s ease infinite;
        }
        body.theme-bloomberg .icon-placeholder {
            background: linear-gradient(135deg, #333333 0%, #1a1a1a 100%);
            border: 2px solid #ff6600;
        }
        body.theme-bloomberg .project-tile span {
            color: #ff6600 !important;
            font-weight: 600;
            font-family: 'Courier New', monospace;
        }
        
        /* Ocean Theme */
        body.theme-ocean .project-tile {
            background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
        }
        body.theme-ocean .project-tile:hover::before {
            background: linear-gradient(45deg, #06b6d4, #0891b2, #0e7490, #155e75);
            background-size: 300% 300%;
            animation: oceanWave 2s ease infinite;
        }
        body.theme-ocean .icon-placeholder {
            background: linear-gradient(135deg, #1e40af 0%, #1e3a8a 100%);
            border: 2px solid #0ea5e9;
        }
        
        /* Forest Theme */
        body.theme-forest .project-tile {
            background: linear-gradient(135deg, #166534 0%, #15803d 100%);
        }
        body.theme-forest .project-tile:hover::before {
            background: linear-gradient(45deg, #22c55e, #16a34a, #15803d, #166534);
            background-size: 300% 300%;
            animation: forestGrow 2s ease infinite;
        }
        body.theme-forest .icon-placeholder {
            background: linear-gradient(135deg, #15803d 0%, #166534 100%);
            border: 2px solid #22c55e;
        }
        
        /* Animations */
        @keyframes electricBlue {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        @keyframes spaceGlow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        @keyframes bloombergPulse {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        @keyframes oceanWave {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        @keyframes forestGrow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        /* Theme Selector Styles */
        .theme-selector {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        /* Modal Styles */
        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(8px);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: rgba(31, 41, 55, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(16px);
            padding: 32px;
            min-width: 400px;
            position: relative;
        }
        
        .modal-close {
            position: absolute;
            top: 16px;
            right: 16px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 8px;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background 0.2s ease;
            color: #9ca3af;
        }
        
        .modal-close:hover {
            background: rgba(255, 255, 255, 0.2);
            color: #ffffff;
        }
        
        .new-project-tile {
            border: 2px dashed rgba(255, 255, 255, 0.3);
            background: transparent !important;
            transition: all 0.3s ease;
        }
        
        .new-project-tile:hover {
            border-color: rgba(255, 255, 255, 0.6);
            background: rgba(255, 255, 255, 0.05) !important;
        }
        
        .new-project-tile::before {
            display: none;
        }
        
        /* Context Menu Styles */
        .context-menu {
            position: fixed;
            background: rgba(31, 41, 55, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(16px);
            z-index: 3000;
            min-width: 120px;
            overflow: hidden;
        }
        
        .context-menu-item {
            padding: 12px 16px;
            color: #d1d5db;
            cursor: pointer;
            transition: background 0.2s ease;
            font-size: 14px;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .context-menu-item:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #ffffff;
        }
        
        .context-menu-item.danger:hover {
            background: rgba(239, 68, 68, 0.2);
            color: #fca5a5;
        }
        
        .confirm-delete-modal .modal-content {
            max-width: 400px;
        }
        
        .theme-button {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 4px;
        }
        
        .theme-button:hover {
            transform: scale(1.1);
            border-color: rgba(255, 255, 255, 0.5);
        }
        
        .theme-button.active {
            border-color: #fff;
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.3);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Helper functions for localStorage persistence
        const saveProjectsToLocalStorage = (projects) => {
            try {
                localStorage.setItem('spatium_projects', JSON.stringify(projects));
            } catch (error) {
                console.error('Failed to save projects to localStorage:', error);
            }
        };

        const loadProjectsFromLocalStorage = () => {
            try {
                const savedProjects = localStorage.getItem('spatium_projects');
                if (savedProjects) {
                    return JSON.parse(savedProjects);
                }
            } catch (error) {
                console.error('Failed to load projects from localStorage:', error);
            }
            
            // Return default projects if no saved data or error occurred
            return getDefaultProjects();
        };

        const getDefaultProjects = () => {
            // Helper function to get initial grid positions
            const getInitialGridPositions = () => {
                const positions = [];
                const GRID_SIZE = 180; // 150px tile + 30px spacing
                const MARGIN = 30; // Margin from screen edges
                const cols = Math.floor((window.innerWidth - 2 * MARGIN) / GRID_SIZE);
                
                for (let i = 0; i < 10; i++) {
                    const col = i % cols;
                    const row = Math.floor(i / cols);
                    const x = MARGIN + col * GRID_SIZE;
                    const y = MARGIN + row * GRID_SIZE;
                    positions.push({ x, y });
                }
                
                return positions;
            };

            const initialPositions = getInitialGridPositions();
            return [
                { id: 1, name: 'Spatium', isSetupComplete: true, ...initialPositions[0] },
                { id: 2, name: 'AI Voice App', isSetupComplete: true, ...initialPositions[1] },
                { id: 3, name: 'Fitness Tracker', isSetupComplete: true, ...initialPositions[2] },
                { id: 4, name: 'Personal Website', isSetupComplete: true, ...initialPositions[3] },
                { id: 5, name: 'Marketing Blog', isSetupComplete: true, ...initialPositions[4] },
                { id: 6, name: 'E-commerce Store', isSetupComplete: true, ...initialPositions[5] },
                { id: 7, name: 'Weather Dashboard', isSetupComplete: true, ...initialPositions[6] },
                { id: 8, name: 'Task Manager', isSetupComplete: true, ...initialPositions[7] },
                { id: 9, name: 'Photo Gallery', isSetupComplete: true, ...initialPositions[8] },
                { id: 10, name: 'Music Player', isSetupComplete: true, ...initialPositions[9] }
            ];
        };

        function ProjectView({ project, onGoBack }) {
            const [selectedTemplate, setSelectedTemplate] = useState(null);
            const [userInput, setUserInput] = useState('');
            const [generatedContent, setGeneratedContent] = useState('');
            const [isGenerating, setIsGenerating] = useState(false);

            // Structured template library grouped by categories
            const templateLibrary = {
                'Product Strategy': [
                    {
                        id: 1,
                        name: 'Product Roadmap Generator',
                        description: 'Generate comprehensive product roadmaps with AI-powered milestone planning, feature prioritization, and timeline optimization. Perfect for product managers looking to create data-driven roadmaps that align with business objectives.',
                        promptTemplate: `Based on the project "${project.name}", which can be described as "${project.oneSentencePitch || 'a new project'}", create a comprehensive product roadmap. 

The project addresses this problem: ${project.problemStatement || 'Various user needs and market opportunities'}

Target audience: ${project.targetAudience || 'General users'}

Unique solution approach: ${project.uniqueSolution || 'Innovative features and user experience'}

Please generate a 6-month product roadmap that includes:
1. Key milestones and deliverables
2. Feature prioritization matrix
3. Timeline with dependencies
4. Success metrics and KPIs
5. Risk assessment and mitigation strategies`
                    },
                    {
                        id: 2,
                        name: 'Market Research Assistant',
                        description: 'Conduct thorough market analysis using AI to identify trends, competitor landscapes, and customer insights. This template helps you gather and synthesize market data to make informed strategic decisions.',
                        promptTemplate: `For the project "${project.name}" - ${project.oneSentencePitch || 'a new venture'}, conduct a comprehensive market research analysis.

Problem being solved: ${project.problemStatement || 'Market needs analysis required'}

Target market: ${project.targetAudience || 'Market segments to be identified'}

Competitive advantage: ${project.uniqueSolution || 'Differentiation factors to be analyzed'}

Please provide:
1. Market size and growth potential analysis
2. Competitive landscape mapping
3. Target customer segment analysis
4. Market trends and opportunities
5. Pricing strategy recommendations
6. Go-to-market strategy insights`
                    },
                    {
                        id: 3,
                        name: 'User Persona Creator',
                        description: 'Build detailed user personas based on data analysis and behavioral patterns. This AI template helps create accurate representations of your target audience for better product development.',
                        promptTemplate: `Create detailed user personas for "${project.name}" - ${project.oneSentencePitch || 'our project'}.

Target audience: ${project.targetAudience || 'Users to be defined'}

Problem we solve: ${project.problemStatement || 'User pain points to be identified'}

Our unique approach: ${project.uniqueSolution || 'Solution differentiation'}

Generate 3-4 detailed user personas including:
1. Demographics and psychographics
2. Goals, motivations, and pain points
3. Behavioral patterns and preferences
4. Technology adoption and usage patterns
5. Decision-making processes
6. Key messaging that resonates with each persona`
                    }
                ],
                'Marketing & Sales': [
                    {
                        id: 4,
                        name: 'Campaign Performance Optimizer',
                        description: 'Analyze and optimize marketing campaigns using AI-driven insights. Track performance metrics, identify improvement opportunities, and generate actionable recommendations for better ROI.',
                        promptTemplate: `Optimize marketing campaigns for "${project.name}" - ${project.oneSentencePitch || 'our product'}.

Target audience: ${project.targetAudience || 'Marketing targets to be defined'}

Value proposition: ${project.uniqueSolution || 'Key benefits to highlight'}

Market challenge: ${project.problemStatement || 'Market education needs'}

Create a campaign optimization strategy including:
1. Channel-specific messaging and creative recommendations
2. Audience segmentation and targeting strategies
3. Performance metrics and KPI tracking framework
4. A/B testing recommendations
5. Budget allocation optimization
6. Conversion funnel improvement tactics`
                    },
                    {
                        id: 5,
                        name: 'Content Strategy Planner',
                        description: 'Create compelling content strategies with AI assistance. Generate content calendars, topic suggestions, and performance predictions to maximize engagement and reach.',
                        promptTemplate: `Develop a comprehensive content strategy for "${project.name}" - ${project.oneSentencePitch || 'our brand'}.

Audience: ${project.targetAudience || 'Content audience to be defined'}

Core message: ${project.uniqueSolution || 'Brand differentiation to communicate'}

Problem focus: ${project.problemStatement || 'Issues to address through content'}

Generate:
1. 3-month content calendar with themes and topics
2. Content pillar strategy aligned with brand values
3. Platform-specific content recommendations
4. SEO keyword strategy and content optimization
5. Engagement tactics and community building approach
6. Content performance measurement framework`
                    },
                    {
                        id: 6,
                        name: 'Sales Funnel Analyzer',
                        description: 'Optimize your sales process with AI-powered funnel analysis. Identify bottlenecks, predict conversion rates, and get recommendations for improving sales performance.',
                        promptTemplate: `Analyze and optimize the sales funnel for "${project.name}" - ${project.oneSentencePitch || 'our offering'}.

Target customers: ${project.targetAudience || 'Customer segments to be analyzed'}

Value proposition: ${project.uniqueSolution || 'Unique selling points'}

Customer problem: ${project.problemStatement || 'Pain points driving purchase decisions'}

Provide:
1. Complete sales funnel mapping from awareness to conversion
2. Conversion rate optimization recommendations
3. Lead qualification and scoring framework
4. Sales enablement materials and messaging
5. Customer objection handling strategies
6. Retention and upselling opportunities analysis`
                    }
                ],
                'Technical': [
                    {
                        id: 7,
                        name: 'Code Review Assistant',
                        description: 'Automate code quality checks and get intelligent suggestions for improvements. This AI template helps maintain coding standards and identifies potential issues before deployment.',
                        promptTemplate: `Create a code review and quality assurance framework for "${project.name}" - ${project.oneSentencePitch || 'our technical project'}.

Technical challenge: ${project.problemStatement || 'Development challenges to address'}

User base: ${project.targetAudience || 'End users and their technical needs'}

Technical advantage: ${project.uniqueSolution || 'Technology differentiation'}

Develop:
1. Code review checklist and standards
2. Automated testing strategy and coverage requirements
3. Performance monitoring and optimization guidelines
4. Security audit procedures and compliance requirements
5. Documentation standards and API guidelines
6. Deployment and CI/CD pipeline recommendations`
                    },
                    {
                        id: 8,
                        name: 'Performance Monitor',
                        description: 'Monitor application performance with AI-driven anomaly detection. Get real-time insights, predictive alerts, and optimization recommendations for your technical infrastructure.',
                        promptTemplate: `Design a comprehensive performance monitoring strategy for "${project.name}" - ${project.oneSentencePitch || 'our application'}.

System requirements driven by: ${project.problemStatement || 'Performance challenges to solve'}

User expectations: ${project.targetAudience || 'User base performance needs'}

Technical edge: ${project.uniqueSolution || 'Performance advantages to maintain'}

Create:
1. Performance metrics and KPI framework
2. Real-time monitoring and alerting system design
3. Load testing and capacity planning strategy
4. Database and API optimization recommendations
5. User experience performance tracking
6. Incident response and performance recovery procedures`
                    },
                    {
                        id: 9,
                        name: 'API Documentation Generator',
                        description: 'Automatically generate comprehensive API documentation with AI assistance. Create clear, well-structured docs that improve developer experience and reduce support overhead.',
                        promptTemplate: `Generate comprehensive API documentation for "${project.name}" - ${project.oneSentencePitch || 'our platform'}.

Developer needs based on: ${project.problemStatement || 'Integration challenges to solve'}

Target developers: ${project.targetAudience || 'Developer community and their needs'}

API advantages: ${project.uniqueSolution || 'Unique API features and benefits'}

Produce:
1. Complete API reference documentation with examples
2. Getting started guide and authentication setup
3. SDK and integration tutorials for popular frameworks
4. Error handling and troubleshooting guide
5. Rate limiting and best practices documentation
6. Interactive API explorer and testing interface design`
                    }
                ]
            };

            const handleTemplateSelect = (template) => {
                setSelectedTemplate(template);
                
                // Generate pre-filled prompt using project core data
                if (template.promptTemplate) {
                    // Create a function to safely replace template literals
                    const generatePrompt = (templateStr, projectData) => {
                        try {
                            // Use a function to replace template literal syntax
                            return templateStr.replace(/\$\{([^}]+)\}/g, (match, expression) => {
                                // Safely evaluate simple property access
                                if (expression.includes('project.name')) {
                                    return projectData.name || 'Untitled Project';
                                } else if (expression.includes('project.oneSentencePitch')) {
                                    return projectData.oneSentencePitch || 'a new project';
                                } else if (expression.includes('project.problemStatement')) {
                                    return projectData.problemStatement || 'Various user needs and market opportunities';
                                } else if (expression.includes('project.targetAudience')) {
                                    return projectData.targetAudience || 'General users';
                                } else if (expression.includes('project.uniqueSolution')) {
                                    return projectData.uniqueSolution || 'Innovative features and user experience';
                                }
                                return match; // Return original if no match found
                            });
                        } catch (error) {
                            console.error('Error generating prompt:', error);
                            return `Generate content for the ${template.name} template based on the project "${projectData.name}".`;
                        }
                    };
                    
                    const preFilledPrompt = generatePrompt(template.promptTemplate, project);
                    setUserInput(preFilledPrompt);
                } else {
                    // Fallback for templates without promptTemplate
                    setUserInput(`Generate content for the ${template.name} template based on the project "${project.name}".`);
                }
                
                // Clear any previous generated content
                setGeneratedContent('');
            };

            const handleGenerate = () => {
                if (selectedTemplate && userInput.trim()) {
                    // Set loading state and clear previous content
                    setIsGenerating(true);
                    setGeneratedContent('');
                    
                    // Simulate AI API call with 2-second delay
                    setTimeout(() => {
                        // Create a realistic AI response based on the selected template
                        const aiResponse = `Based on your prompt for '${selectedTemplate.name}', here is a generated response:

${generateTemplateResponse(selectedTemplate, project, userInput)}

---

This response was generated using advanced AI analysis of your project requirements and the specific template context. You can use this as a starting point and customize it further based on your specific needs and goals.`;
                        
                        setGeneratedContent(aiResponse);
                        setIsGenerating(false);
                    }, 2000);
                }
            };

            // Helper function to generate template-specific responses
            const generateTemplateResponse = (template, project, input) => {
                const responses = {
                    'Product Roadmap Generator': `üöÄ **6-Month Product Roadmap for ${project.name}**

**Phase 1 (Months 1-2): Foundation & Core Features**
‚Ä¢ MVP development with essential functionality addressing: ${project.problemStatement || 'core user needs'}
‚Ä¢ User authentication and onboarding flow
‚Ä¢ Basic analytics implementation
‚Ä¢ Initial user testing with ${project.targetAudience || 'target audience'}

**Phase 2 (Months 3-4): Enhancement & Scaling** 
‚Ä¢ Advanced feature rollout leveraging: ${project.uniqueSolution || 'key differentiators'}
‚Ä¢ Performance optimization and scaling infrastructure
‚Ä¢ Customer feedback integration and iterative improvements
‚Ä¢ Partnership and integration opportunities

**Phase 3 (Months 5-6): Market Expansion**
‚Ä¢ Advanced analytics and reporting capabilities
‚Ä¢ Multi-platform expansion strategy
‚Ä¢ Revenue optimization and monetization features
‚Ä¢ Market penetration analysis and growth metrics

**Success Metrics:**
‚Ä¢ User acquisition: 10,000+ active users
‚Ä¢ Retention rate: 70%+ monthly active users
‚Ä¢ Customer satisfaction: 4.5+ star rating
‚Ä¢ Revenue targets: $50K+ monthly recurring revenue`,

                    'Market Research Assistant': `üìä **Comprehensive Market Analysis for ${project.name}**

**Market Size & Opportunity:**
The market addressing "${project.problemStatement || 'similar challenges'}" is estimated at $2.5B+ globally, with 15% annual growth driven by increasing demand for solutions targeting ${project.targetAudience || 'similar user segments'}.

**Competitive Landscape:**
‚Ä¢ 3 major incumbents with 60% market share
‚Ä¢ 12+ emerging startups with innovative approaches
‚Ä¢ Gap identified: ${project.uniqueSolution || 'differentiated value proposition'} represents underserved market segment

**Target Customer Analysis:**
Primary segment: ${project.targetAudience || 'Defined user base'}
‚Ä¢ Pain points: High demand for solutions addressing core problems
‚Ä¢ Spending power: $500-2000 annual budget for related solutions
‚Ä¢ Decision factors: Quality, ease of use, and proven ROI

**Go-to-Market Recommendations:**
1. Direct-to-consumer digital marketing focusing on problem-solution fit
2. Strategic partnerships with complementary service providers
3. Content marketing emphasizing unique value proposition
4. Freemium model to drive adoption and convert to paid tiers`,

                    'User Persona Creator': `üë• **Detailed User Personas for ${project.name}**

**Primary Persona: "The Problem Solver"**
‚Ä¢ Demographics: 28-45 years old, college-educated, $75K+ household income
‚Ä¢ Psychographics: Tech-savvy early adopter, values efficiency and innovation
‚Ä¢ Goals: Seeking solutions for "${project.problemStatement || 'daily challenges'}"
‚Ä¢ Pain Points: Current solutions are too complex, expensive, or ineffective
‚Ä¢ Technology Usage: Heavy smartphone user, adopts new apps quickly
‚Ä¢ Decision Process: Researches thoroughly, reads reviews, tests free trials

**Secondary Persona: "The Practical User"**
‚Ä¢ Demographics: 35-55 years old, established professional, values reliability
‚Ä¢ Motivations: Needs proven solutions for ${project.targetAudience || 'specific use cases'}
‚Ä¢ Behavior: Cautious adopter, prefers recommendations from peers
‚Ä¢ Budget: Willing to pay premium for quality and support

**Persona Insights:**
‚Ä¢ Both segments respond to messaging about ${project.uniqueSolution || 'key benefits'}
‚Ä¢ Trust-building content and social proof are crucial conversion factors
‚Ä¢ Mobile-first experience is essential for engagement`,

                    'Campaign Performance Optimizer': `üìà **Campaign Optimization Strategy for ${project.name}**

**Channel Performance Analysis:**
‚Ä¢ Digital channels show 340% higher ROI when messaging focuses on ${project.uniqueSolution || 'core value proposition'}
‚Ä¢ Social media campaigns targeting ${project.targetAudience || 'primary demographic'} achieve 2.8x engagement rates
‚Ä¢ Email marketing sequences addressing "${project.problemStatement || 'key pain points'}" show 45% open rates

**Optimization Recommendations:**
1. **Creative Strategy:** Emphasize problem-solution fit with testimonials
2. **Audience Targeting:** Expand lookalike audiences based on early adopters
3. **Budget Allocation:** 60% digital advertising, 25% content marketing, 15% partnerships
4. **A/B Testing:** Headlines focusing on outcomes vs. features show 23% lift

**Conversion Funnel Improvements:**
‚Ä¢ Landing page optimization: Clear value proposition + social proof
‚Ä¢ Lead magnet: Free tool/assessment related to core problem
‚Ä¢ Nurture sequence: 5-email series building trust and demonstrating value
‚Ä¢ Retargeting: Focus on feature benefits for consideration-stage prospects`,

                    'Content Strategy Planner': `üìù **3-Month Content Strategy for ${project.name}**

**Content Pillars:**
1. **Education:** How-to guides addressing ${project.problemStatement || 'industry challenges'}
2. **Innovation:** Thought leadership on ${project.uniqueSolution || 'unique approaches'}
3. **Community:** User stories and success cases from ${project.targetAudience || 'target users'}
4. **Product:** Feature spotlights and use case demonstrations

**Content Calendar Highlights:**
**Month 1: Foundation**
‚Ä¢ Week 1-2: "Ultimate Guide" addressing core problem
‚Ä¢ Week 3-4: Video series showcasing solution benefits

**Month 2: Engagement**
‚Ä¢ Week 1-2: User-generated content campaign
‚Ä¢ Week 3-4: Industry expert collaboration content

**Month 3: Conversion**
‚Ä¢ Week 1-2: Case studies and ROI demonstrations
‚Ä¢ Week 3-4: Product comparison and decision guides

**Distribution Strategy:**
‚Ä¢ Blog: 2x weekly in-depth articles
‚Ä¢ Social: Daily micro-content across platforms
‚Ä¢ Email: Weekly newsletter + automated sequences
‚Ä¢ Video: Bi-weekly educational content for YouTube`,

                    'Sales Funnel Analyzer': `üîÑ **Sales Funnel Optimization for ${project.name}**

**Current Funnel Analysis:**
‚Ä¢ **Awareness:** 10,000 monthly visitors interested in solutions for ${project.problemStatement || 'similar problems'}
‚Ä¢ **Interest:** 1,500 visitors engage with product information
‚Ä¢ **Consideration:** 300 users sign up for trials/demos
‚Ä¢ **Purchase:** 45 conversions (15% trial-to-paid rate)
‚Ä¢ **Retention:** 78% monthly retention rate

**Optimization Opportunities:**
1. **Top of Funnel:** Content targeting ${project.targetAudience || 'ideal customers'} can increase awareness by 40%
2. **Middle Funnel:** Product demos emphasizing ${project.uniqueSolution || 'key differentiators'} improve consideration rates
3. **Bottom Funnel:** Simplified pricing and onboarding increase conversion by 25%

**Recommended Actions:**
‚Ä¢ Lead scoring: Prioritize prospects showing high engagement with key features
‚Ä¢ Sales enablement: Objection handling focused on competitive advantages
‚Ä¢ Follow-up sequences: 7-touch automated campaign for trial users
‚Ä¢ Upselling strategy: Premium features for power users after 30-day usage`,

                    'Code Review Assistant': `üíª **Code Quality Framework for ${project.name}**

**Code Review Standards:**
Given your project focus on ${project.problemStatement || 'technical challenges'} and serving ${project.targetAudience || 'technical users'}, here's a comprehensive quality framework:

**Essential Checkpoints:**
1. **Security Review:** Input validation, authentication, data encryption
2. **Performance Standards:** Load time <2s, API response <500ms
3. **Code Quality:** Cyclomatic complexity <10, test coverage >80%
4. **Documentation:** API docs, inline comments, README completeness

**Automated Testing Strategy:**
‚Ä¢ Unit tests: 85%+ coverage for core business logic
‚Ä¢ Integration tests: Critical user journeys and API endpoints
‚Ä¢ E2E tests: Key user workflows related to ${project.uniqueSolution || 'core features'}
‚Ä¢ Performance tests: Load testing for expected user volumes

**CI/CD Pipeline:**
‚Ä¢ Pre-commit hooks: Linting, formatting, basic security scans
‚Ä¢ Build pipeline: Automated testing, dependency vulnerability checks
‚Ä¢ Deployment: Staged rollouts with monitoring and rollback capabilities
‚Ä¢ Monitoring: Real-time performance tracking and error alerting`,

                    'Performance Monitor': `‚ö° **Performance Monitoring Strategy for ${project.name}**

**Key Performance Metrics:**
Based on your target audience of ${project.targetAudience || 'users'} and focus on ${project.problemStatement || 'system requirements'}, monitor these critical metrics:

**User Experience Metrics:**
‚Ä¢ Page load times: <2 seconds for 95th percentile
‚Ä¢ Time to interactive: <3 seconds on mobile devices
‚Ä¢ Core Web Vitals: LCP <2.5s, FID <100ms, CLS <0.1
‚Ä¢ Error rates: <0.1% for critical user journeys

**System Performance:**
‚Ä¢ API response times: <500ms for 99% of requests
‚Ä¢ Database query performance: <100ms average
‚Ä¢ Memory usage: <80% of allocated resources
‚Ä¢ CPU utilization: <70% during peak traffic

**Monitoring Implementation:**
‚Ä¢ Real-time dashboards for ${project.uniqueSolution || 'key features'}
‚Ä¢ Automated alerts for performance degradation
‚Ä¢ User session recordings for UX optimization
‚Ä¢ A/B testing framework for performance improvements

**Incident Response:**
‚Ä¢ Automated rollback triggers for performance regressions
‚Ä¢ On-call rotation for critical system components
‚Ä¢ Post-incident reviews and performance optimization`,

                    'API Documentation Generator': `üìö **API Documentation Strategy for ${project.name}**

**Documentation Structure:**
For developers integrating with your platform serving ${project.targetAudience || 'target developers'} and addressing ${project.problemStatement || 'integration challenges'}:

**Getting Started Guide:**
1. **Authentication Setup:** API key generation and OAuth implementation
2. **Quick Start:** 5-minute integration tutorial with working examples
3. **SDKs:** Language-specific libraries (JavaScript, Python, PHP, Ruby)
4. **Sandbox Environment:** Test API with sample data

**API Reference:**
‚Ä¢ **Core Endpoints:** CRUD operations for main resources
‚Ä¢ **Advanced Features:** Leveraging ${project.uniqueSolution || 'unique capabilities'}
‚Ä¢ **Webhooks:** Real-time event notifications
‚Ä¢ **Rate Limits:** Usage guidelines and optimization tips

**Developer Experience:**
‚Ä¢ Interactive API explorer with live testing
‚Ä¢ Code examples in multiple programming languages
‚Ä¢ Error handling guides with common solutions
‚Ä¢ Community forum and support channels
‚Ä¢ Version migration guides and changelog

**Best Practices:**
‚Ä¢ Pagination for large datasets
‚Ä¢ Caching strategies for optimal performance
‚Ä¢ Security guidelines and compliance requirements
‚Ä¢ Testing strategies and debugging tools`
                };

                return responses[template.name] || `Here's a comprehensive analysis for your ${template.name} request:

This AI-generated response addresses your specific needs for "${project.name}" by leveraging the context you provided about ${project.problemStatement || 'your project challenges'}.

Key recommendations include:
‚Ä¢ Strategic approach tailored to ${project.targetAudience || 'your target audience'}
‚Ä¢ Implementation of ${project.uniqueSolution || 'your unique solutions'}
‚Ä¢ Measurable outcomes and success metrics
‚Ä¢ Next steps for immediate implementation

The analysis incorporates industry best practices while considering your specific project requirements and constraints.`;
            };

            return (
                <div className="min-h-screen flex flex-col">
                    {/* Header */}
                    <div className="p-6 border-b border-white border-opacity-10">
                        <div className="flex items-center justify-between">
                            <div className="flex items-center space-x-4">
                                <button 
                                    onClick={onGoBack}
                                    className="text-gray-400 hover:text-white transition-colors duration-200 flex items-center space-x-2"
                                >
                                    <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7" />
                                    </svg>
                                    <span>Back to Dashboard</span>
                                </button>
                                
                                <div className="w-8 h-8 rounded-lg bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center">
                                    <svg className="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
                                    </svg>
                                </div>
                                
                                <h1 className="text-2xl font-bold text-white">{project.name}</h1>
                            </div>
                        </div>
                    </div>

                    {/* Two-column layout */}
                    <div className="flex-1 flex">
                        {/* Left Column - Template Library */}
                        <div className="w-1/3 border-r border-white border-opacity-10 p-6 overflow-y-auto">
                            <h2 className="text-lg font-semibold text-white mb-6">AI Template Library</h2>
                            
                            {Object.entries(templateLibrary).map(([category, templates]) => (
                                <div key={category} className="mb-8">
                                    {/* Category Header */}
                                    <h3 className="text-sm font-medium text-gray-400 uppercase tracking-wide mb-3">
                                        {category}
                                    </h3>
                                    
                                    {/* Template List */}
                                    <div className="space-y-2">
                                        {templates.map((template) => (
                                            <button
                                                key={template.id}
                                                onClick={() => handleTemplateSelect(template)}
                                                className={`w-full text-left p-3 rounded-lg transition-all duration-200 ${
                                                    selectedTemplate?.id === template.id
                                                        ? 'bg-blue-600 text-white shadow-lg'
                                                        : 'text-gray-300 hover:bg-white hover:bg-opacity-5 hover:text-white'
                                                }`}
                                            >
                                                <div className="font-medium text-sm">{template.name}</div>
                                            </button>
                                        ))}
                                    </div>
                                </div>
                            ))}
                        </div>

                        {/* Right Column - Template Details & AI Generation */}
                        <div className="flex-1 p-8">
                            {selectedTemplate ? (
                                <div className="h-full flex flex-col">
                                    {/* Template Header */}
                                    <div className="mb-6">
                                        <h2 className="text-3xl font-bold text-white mb-4">
                                            {selectedTemplate.name}
                                        </h2>
                                        <p className="text-gray-300 text-lg leading-relaxed">
                                            {selectedTemplate.description}
                                        </p>
                                    </div>
                                    
                                    {/* AI Generation Interface */}
                                    <div className="flex-1 flex flex-col space-y-6">
                                        {/* Generated Content Output Area */}
                                        <div className="flex-1 min-h-0">
                                            <h3 className="text-lg font-semibold text-white mb-3">Generated Output</h3>
                                            <div className="h-full bg-gray-800 bg-opacity-50 border border-gray-600 rounded-xl p-4 overflow-y-auto">
                                                {isGenerating ? (
                                                    <div className="flex items-center justify-center h-full">
                                                        <div className="text-center">
                                                            <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto mb-4"></div>
                                                            <div className="text-blue-400 font-medium">Generating...</div>
                                                            <div className="text-gray-500 text-sm mt-2">AI is analyzing your prompt and creating a response</div>
                                                        </div>
                                                    </div>
                                                ) : generatedContent ? (
                                                    <div className="text-gray-300 whitespace-pre-wrap">
                                                        {generatedContent}
                                                    </div>
                                                ) : (
                                                    <div className="text-gray-500 italic">
                                                        {selectedTemplate 
                                                            ? "Generated content will appear here after you review the pre-filled prompt and click Generate..."
                                                            : "Select a template from the left to auto-generate a customized prompt based on your project core data..."
                                                        }
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                        
                                        {/* User Input Area */}
                                        <div className="space-y-3">
                                            <h3 className="text-lg font-semibold text-white">Your Input</h3>
                                            <textarea
                                                value={userInput}
                                                onChange={(e) => setUserInput(e.target.value)}
                                                placeholder={selectedTemplate ? `Template loaded! Review and edit the pre-filled ${selectedTemplate.name} prompt...` : `Select a template to auto-generate a customized prompt...`}
                                                className="w-full h-32 bg-gray-800 bg-opacity-50 border border-gray-600 rounded-xl p-4 text-white placeholder-gray-400 resize-none focus:outline-none focus:border-blue-500 transition-colors"
                                            />
                                            
                                            {/* Generate Button */}
                                            <button 
                                                onClick={handleGenerate}
                                                disabled={!userInput.trim() || isGenerating}
                                                className="bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white font-semibold py-3 px-6 rounded-xl transition-colors duration-200 flex items-center space-x-2"
                                            >
                                                {isGenerating ? (
                                                    <>
                                                        <div className="animate-spin rounded-full h-4 w-4 border-b-2 border-white"></div>
                                                        <span>Generating...</span>
                                                    </>
                                                ) : (
                                                    <>
                                                        <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 10V3L4 14h7v7l9-11h-7z" />
                                                        </svg>
                                                        <span>Generate</span>
                                                    </>
                                                )}
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            ) : (
                                <div className="flex items-center justify-center h-full">
                                    <div className="text-center">
                                        <svg className="w-16 h-16 text-gray-500 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                        </svg>
                                        <h3 className="text-xl font-medium text-gray-400 mb-2">
                                            Select a template to get started
                                        </h3>
                                        <p className="text-gray-500">
                                            Choose a template from the list to auto-generate a customized prompt using your project core data.
                                        </p>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        function ProjectCoreWizard({ project, onGoBack, onCompleteSetup }) {
            const [formData, setFormData] = useState({
                oneSentencePitch: '',
                problemStatement: '',
                targetAudience: '',
                uniqueSolution: ''
            });

            const handleInputChange = (field, value) => {
                setFormData(prev => ({
                    ...prev,
                    [field]: value
                }));
            };

            const handleSaveAndBegin = () => {
                // Check if all fields are filled
                if (Object.values(formData).every(value => value.trim() !== '')) {
                    onCompleteSetup(project.id, formData);
                }
            };

            const isFormComplete = Object.values(formData).every(value => value.trim() !== '');

            return (
                <div className="min-h-screen flex flex-col">
                    {/* Header */}
                    <div className="p-6 border-b border-white border-opacity-10">
                        <div className="flex items-center justify-between">
                            <div className="flex items-center space-x-4">
                                <button 
                                    onClick={onGoBack}
                                    className="text-gray-400 hover:text-white transition-colors duration-200 flex items-center space-x-2"
                                >
                                    <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7" />
                                    </svg>
                                    <span>Back to Dashboard</span>
                                </button>
                                
                                <div className="w-8 h-8 rounded-lg bg-gradient-to-br from-green-500 to-blue-600 flex items-center justify-center">
                                    <svg className="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                                    </svg>
                                </div>
                                
                                <h1 className="text-2xl font-bold text-white">Define Your Project Core</h1>
                            </div>
                        </div>
                        <p className="text-gray-300 mt-2 ml-16">
                            Let's establish the foundation for <span className="font-semibold text-white">"{project.name}"</span> by defining its core elements.
                        </p>
                    </div>

                    {/* Wizard Content */}
                    <div className="flex-1 p-8 max-w-4xl mx-auto w-full">
                        <div className="space-y-8">
                            {/* One-Sentence Pitch */}
                            <div>
                                <label className="block text-lg font-semibold text-white mb-3">
                                    One-Sentence Pitch
                                </label>
                                <p className="text-gray-400 text-sm mb-4">
                                    Describe your project in one compelling sentence that captures its essence.
                                </p>
                                <textarea
                                    value={formData.oneSentencePitch}
                                    onChange={(e) => handleInputChange('oneSentencePitch', e.target.value)}
                                    placeholder="Example: A revolutionary mobile app that connects local farmers directly with consumers for fresh, sustainable produce delivery."
                                    className="w-full h-24 bg-gray-800 bg-opacity-50 border border-gray-600 rounded-xl p-4 text-white placeholder-gray-400 resize-none focus:outline-none focus:border-blue-500 transition-colors"
                                />
                            </div>

                            {/* Problem Statement */}
                            <div>
                                <label className="block text-lg font-semibold text-white mb-3">
                                    Problem Statement
                                </label>
                                <p className="text-gray-400 text-sm mb-4">
                                    What specific problem does your project solve? Why is this problem important?
                                </p>
                                <textarea
                                    value={formData.problemStatement}
                                    onChange={(e) => handleInputChange('problemStatement', e.target.value)}
                                    placeholder="Describe the pain point, challenge, or opportunity your project addresses..."
                                    className="w-full h-32 bg-gray-800 bg-opacity-50 border border-gray-600 rounded-xl p-4 text-white placeholder-gray-400 resize-none focus:outline-none focus:border-blue-500 transition-colors"
                                />
                            </div>

                            {/* Target Audience */}
                            <div>
                                <label className="block text-lg font-semibold text-white mb-3">
                                    Target Audience
                                </label>
                                <p className="text-gray-400 text-sm mb-4">
                                    Who are you building this for? Be specific about demographics, behaviors, and needs.
                                </p>
                                <textarea
                                    value={formData.targetAudience}
                                    onChange={(e) => handleInputChange('targetAudience', e.target.value)}
                                    placeholder="Define your primary users, their characteristics, and what they care about..."
                                    className="w-full h-32 bg-gray-800 bg-opacity-50 border border-gray-600 rounded-xl p-4 text-white placeholder-gray-400 resize-none focus:outline-none focus:border-blue-500 transition-colors"
                                />
                            </div>

                            {/* Unique Solution */}
                            <div>
                                <label className="block text-lg font-semibold text-white mb-3">
                                    Unique Solution
                                </label>
                                <p className="text-gray-400 text-sm mb-4">
                                    What makes your approach different? How does your solution stand out from alternatives?
                                </p>
                                <textarea
                                    value={formData.uniqueSolution}
                                    onChange={(e) => handleInputChange('uniqueSolution', e.target.value)}
                                    placeholder="Explain your unique value proposition and competitive advantages..."
                                    className="w-full h-32 bg-gray-800 bg-opacity-50 border border-gray-600 rounded-xl p-4 text-white placeholder-gray-400 resize-none focus:outline-none focus:border-blue-500 transition-colors"
                                />
                            </div>

                            {/* Save Button */}
                            <div className="pt-6 border-t border-gray-600">
                                <button
                                    onClick={handleSaveAndBegin}
                                    disabled={!isFormComplete}
                                    className="w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 disabled:from-gray-600 disabled:to-gray-600 disabled:cursor-not-allowed text-white font-semibold py-4 px-8 rounded-xl transition-all duration-200 flex items-center justify-center space-x-2"
                                >
                                    <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                                    </svg>
                                    <span>Save and Begin Project</span>
                                </button>
                                {!isFormComplete && (
                                    <p className="text-gray-400 text-sm text-center mt-2">
                                        Please fill in all fields to continue
                                    </p>
                                )}
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        function ProjectModal({ isOpen, onClose, onCreateProject }) {
            const [projectName, setProjectName] = useState('');

            const handleSubmit = (e) => {
                e.preventDefault();
                if (projectName.trim()) {
                    onCreateProject(projectName.trim());
                    setProjectName('');
                }
            };

            const handleClose = () => {
                setProjectName('');
                onClose();
            };

            if (!isOpen) return null;

            return (
                <div className="modal-backdrop" onClick={handleClose}>
                    <div className="modal-content" onClick={(e) => e.stopPropagation()}>
                        <button className="modal-close" onClick={handleClose}>
                            <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                            </svg>
                        </button>
                        
                        <h2 className="text-2xl font-bold text-white mb-6">Create New Project</h2>
                        
                        <form onSubmit={handleSubmit} className="space-y-6">
                            <div>
                                <label htmlFor="projectName" className="block text-sm font-medium text-gray-300 mb-2">
                                    Project Name
                                </label>
                                <input
                                    type="text"
                                    id="projectName"
                                    value={projectName}
                                    onChange={(e) => setProjectName(e.target.value)}
                                    placeholder="Enter project name..."
                                    className="w-full px-4 py-3 bg-gray-800 bg-opacity-50 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:border-blue-500 transition-colors"
                                    autoFocus
                                />
                            </div>
                            
                            <div className="flex space-x-3">
                                <button
                                    type="submit"
                                    disabled={!projectName.trim()}
                                    className="flex-1 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white font-semibold py-3 px-6 rounded-xl transition-colors duration-200"
                                >
                                    Create Project
                                </button>
                                <button
                                    type="button"
                                    onClick={handleClose}
                                    className="px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-xl transition-colors duration-200"
                                >
                                    Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            );
        }

        function ContextMenu({ isOpen, position, onClose, onRename, onDelete }) {
            React.useEffect(() => {
                if (isOpen) {
                    const handleClickOutside = () => onClose();
                    document.addEventListener('click', handleClickOutside);
                    return () => document.removeEventListener('click', handleClickOutside);
                }
            }, [isOpen, onClose]);

            if (!isOpen) return null;

            return (
                <div 
                    className="context-menu" 
                    style={{ 
                        left: `${position.x}px`, 
                        top: `${position.y}px` 
                    }}
                    onClick={(e) => e.stopPropagation()}
                >
                    <button className="context-menu-item" onClick={onRename}>
                        <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                        </svg>
                        Rename
                    </button>
                    <button className="context-menu-item danger" onClick={onDelete}>
                        <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                        </svg>
                        Delete
                    </button>
                </div>
            );
        }

        function RenameModal({ isOpen, onClose, onRename, currentName }) {
            const [projectName, setProjectName] = useState('');

            React.useEffect(() => {
                if (isOpen && currentName) {
                    setProjectName(currentName);
                }
            }, [isOpen, currentName]);

            const handleSubmit = (e) => {
                e.preventDefault();
                if (projectName.trim() && projectName.trim() !== currentName) {
                    onRename(projectName.trim());
                    setProjectName('');
                }
            };

            const handleClose = () => {
                setProjectName('');
                onClose();
            };

            if (!isOpen) return null;

            return (
                <div className="modal-backdrop" onClick={handleClose}>
                    <div className="modal-content" onClick={(e) => e.stopPropagation()}>
                        <button className="modal-close" onClick={handleClose}>
                            <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                            </svg>
                        </button>
                        
                        <h2 className="text-2xl font-bold text-white mb-6">Rename Project</h2>
                        
                        <form onSubmit={handleSubmit} className="space-y-6">
                            <div>
                                <label htmlFor="renameProjectName" className="block text-sm font-medium text-gray-300 mb-2">
                                    Project Name
                                </label>
                                <input
                                    type="text"
                                    id="renameProjectName"
                                    value={projectName}
                                    onChange={(e) => setProjectName(e.target.value)}
                                    placeholder="Enter new project name..."
                                    className="w-full px-4 py-3 bg-gray-800 bg-opacity-50 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:border-blue-500 transition-colors"
                                    autoFocus
                                />
                            </div>
                            
                            <div className="flex space-x-3">
                                <button
                                    type="submit"
                                    disabled={!projectName.trim() || projectName.trim() === currentName}
                                    className="flex-1 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white font-semibold py-3 px-6 rounded-xl transition-colors duration-200"
                                >
                                    Rename
                                </button>
                                <button
                                    type="button"
                                    onClick={handleClose}
                                    className="px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-xl transition-colors duration-200"
                                >
                                    Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            );
        }

        function DeleteConfirmModal({ isOpen, onClose, onDelete, projectName }) {
            if (!isOpen) return null;

            return (
                <div className="modal-backdrop" onClick={onClose}>
                    <div className="modal-content confirm-delete-modal" onClick={(e) => e.stopPropagation()}>
                        <button className="modal-close" onClick={onClose}>
                            <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                            </svg>
                        </button>
                        
                        <div className="text-center">
                            <div className="w-16 h-16 bg-red-100 bg-opacity-20 rounded-full flex items-center justify-center mx-auto mb-4">
                                <svg className="w-8 h-8 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z" />
                                </svg>
                            </div>
                            
                            <h2 className="text-2xl font-bold text-white mb-4">Delete Project</h2>
                            <p className="text-gray-300 mb-6">
                                Are you sure you want to delete <span className="font-semibold text-white">"{projectName}"</span>? 
                                This action cannot be undone.
                            </p>
                            
                            <div className="flex space-x-3">
                                <button
                                    onClick={onDelete}
                                    className="flex-1 bg-red-600 hover:bg-red-700 text-white font-semibold py-3 px-6 rounded-xl transition-colors duration-200"
                                >
                                    Delete
                                </button>
                                <button
                                    onClick={onClose}
                                    className="flex-1 bg-gray-600 hover:bg-gray-700 text-white font-semibold py-3 px-6 rounded-xl transition-colors duration-200"
                                >
                                    Cancel
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        function ThemeSelector({ currentTheme, onThemeChange }) {
            const themes = [
                { id: 'dark', name: 'Dark', color: '#1f2937' },
                { id: 'space', name: 'Space', color: '#1e1b4b' },
                { id: 'bloomberg', name: 'Bloomberg', color: '#000000' },
                { id: 'ocean', name: 'Ocean', color: '#1e3a8a' },
                { id: 'forest', name: 'Forest', color: '#166534' }
            ];

            return (
                <div className="theme-selector">
                    <div className="flex flex-col space-y-2">
                        {themes.map(theme => (
                            <button
                                key={theme.id}
                                className={`theme-button ${currentTheme === theme.id ? 'active' : ''}`}
                                style={{ backgroundColor: theme.color }}
                                onClick={() => onThemeChange(theme.id)}
                                title={`${theme.name} Theme`}
                            />
                        ))}
                    </div>
                </div>
            );
        }

        function ProjectTile({ project, onDragStart, onDrag, onDragEnd, isDragging, onSelect, onContextMenu }) {
            const [dragOffset, setDragOffset] = useState({ x: 0, y: 0 });
            const [dragStartTime, setDragStartTime] = useState(0);
            const [hasDragged, setHasDragged] = useState(false);

            const handleMouseDown = (e) => {
                if (e.button !== 0) return; // Only left mouse button
                
                const rect = e.currentTarget.getBoundingClientRect();
                const offsetX = e.clientX - rect.left;
                const offsetY = e.clientY - rect.top;
                
                setDragOffset({ x: offsetX, y: offsetY });
                setDragStartTime(Date.now());
                setHasDragged(false);
                onDragStart(project.id, { x: offsetX, y: offsetY });
            };

            const handleContextMenu = (e) => {
                e.preventDefault();
                onContextMenu(project, { x: e.clientX, y: e.clientY });
            };

            const handleMouseMove = (e) => {
                if (!isDragging) return;
                
                // Mark that we've dragged if mouse moved significantly
                if (!hasDragged) {
                    setHasDragged(true);
                }
                
                const newX = e.clientX - dragOffset.x;
                const newY = e.clientY - dragOffset.y;
                
                // Constrain within viewport bounds
                const maxX = window.innerWidth - 150; // tile width
                const maxY = window.innerHeight - 150; // tile height
                
                const constrainedX = Math.max(0, Math.min(newX, maxX));
                const constrainedY = Math.max(0, Math.min(newY, maxY));
                
                onDrag(project.id, { x: constrainedX, y: constrainedY });
            };

            const handleMouseUp = () => {
                const dragDuration = Date.now() - dragStartTime;
                
                // If it was a quick click without dragging, treat it as a selection
                if (dragDuration < 200 && !hasDragged) {
                    onSelect(project);
                }
                
                onDragEnd();
            };

            React.useEffect(() => {
                if (isDragging) {
                    document.addEventListener('mousemove', handleMouseMove);
                    document.addEventListener('mouseup', handleMouseUp);
                    
                    return () => {
                        document.removeEventListener('mousemove', handleMouseMove);
                        document.removeEventListener('mouseup', handleMouseUp);
                    };
                }
            }, [isDragging, dragOffset, dragStartTime, hasDragged]);

            return (
                <div 
                    className={`project-tile w-[150px] h-[150px] rounded-3xl flex flex-col items-center justify-center p-4 ${isDragging ? 'dragging' : ''}`}
                    style={{
                        left: `${project.x}px`,
                        top: `${project.y}px`,
                    }}
                    onMouseDown={handleMouseDown}
                    onContextMenu={handleContextMenu}
                >
                    {/* Icon Placeholder */}
                    <div className="icon-placeholder w-12 h-12 rounded-xl mb-3 flex items-center justify-center">
                        <svg 
                            className="w-6 h-6 text-gray-300" 
                            fill="none" 
                            stroke="currentColor" 
                            viewBox="0 0 24 24"
                        >
                            <path 
                                strokeLinecap="round" 
                                strokeLinejoin="round" 
                                strokeWidth={2} 
                                d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" 
                            />
                        </svg>
                    </div>
                    
                    {/* Project Name */}
                    <span className="text-white text-sm font-medium text-center leading-tight">
                        {project.name}
                    </span>
                </div>
            );
        }

        function NewProjectTile({ onCreateNew, position }) {
            return (
                <div 
                    className="project-tile new-project-tile w-[150px] h-[150px] rounded-3xl flex flex-col items-center justify-center p-4 cursor-pointer"
                    style={{
                        left: `${position.x}px`,
                        top: `${position.y}px`,
                    }}
                    onClick={onCreateNew}
                >
                    {/* Plus Icon */}
                    <div className="w-12 h-12 rounded-xl mb-3 flex items-center justify-center">
                        <svg 
                            className="w-8 h-8 text-gray-400" 
                            fill="none" 
                            stroke="currentColor" 
                            viewBox="0 0 24 24"
                        >
                            <path 
                                strokeLinecap="round" 
                                strokeLinejoin="round" 
                                strokeWidth={2} 
                                d="M12 4v16m8-8H4" 
                            />
                        </svg>
                    </div>
                    
                    {/* Label */}
                    <span className="text-gray-400 text-sm font-medium text-center leading-tight">
                        New Project
                    </span>
                </div>
            );
        }

        function Dashboard({ onProjectSelect, onOpenModal, projects, setProjects }) {
            const [currentTheme, setCurrentTheme] = useState('dark');
            const [draggedItemId, setDraggedItemId] = useState(null);
            const [contextMenu, setContextMenu] = useState({ isOpen: false, position: { x: 0, y: 0 }, project: null });
            const [renameModal, setRenameModal] = useState({ isOpen: false, project: null });
            const [deleteModal, setDeleteModal] = useState({ isOpen: false, project: null });

            // Grid configuration
            const GRID_SIZE = 180; // 150px tile + 30px spacing
            const MARGIN = 30; // Margin from screen edges

            // Helper function to snap coordinates to grid
            const snapToGrid = (x, y) => {
                const gridX = Math.round((x - MARGIN) / GRID_SIZE) * GRID_SIZE + MARGIN;
                const gridY = Math.round((y - MARGIN) / GRID_SIZE) * GRID_SIZE + MARGIN;
                
                // Ensure coordinates stay within viewport bounds
                const maxX = window.innerWidth - 150 - MARGIN;
                const maxY = window.innerHeight - 150 - MARGIN;
                
                return {
                    x: Math.max(MARGIN, Math.min(gridX, maxX)),
                    y: Math.max(MARGIN, Math.min(gridY, maxY))
                };
            };

            const handleThemeChange = (theme) => {
                setCurrentTheme(theme);
                document.body.className = `theme-${theme}`;
            };

            const handleDragStart = (itemId, offset) => {
                setDraggedItemId(itemId);
            };

            const handleDrag = (itemId, position) => {
                // During drag, allow free movement (don't snap yet)
                const maxX = window.innerWidth - 150;
                const maxY = window.innerHeight - 150;
                
                const constrainedPosition = {
                    x: Math.max(0, Math.min(position.x, maxX)),
                    y: Math.max(0, Math.min(position.y, maxY))
                };

                setProjects(prevProjects => 
                    prevProjects.map(project => 
                        project.id === itemId 
                            ? { ...project, ...constrainedPosition }
                            : project
                    )
                );
            };

            const handleDragEnd = () => {
                if (draggedItemId) {
                    // Snap to grid when drag ends
                    setProjects(prevProjects => 
                        prevProjects.map(project => {
                            if (project.id === draggedItemId) {
                                const snappedPosition = snapToGrid(project.x, project.y);
                                return { ...project, ...snappedPosition };
                            }
                            return project;
                        })
                    );
                }
                setDraggedItemId(null);
            };

            const handleContextMenu = (project, position) => {
                setContextMenu({ isOpen: true, position, project });
            };

            const handleCloseContextMenu = () => {
                setContextMenu({ isOpen: false, position: { x: 0, y: 0 }, project: null });
            };

            const handleRename = () => {
                setRenameModal({ isOpen: true, project: contextMenu.project });
                handleCloseContextMenu();
            };

            const handleDelete = () => {
                setDeleteModal({ isOpen: true, project: contextMenu.project });
                handleCloseContextMenu();
            };

            const handleRenameProject = (newName) => {
                if (renameModal.project) {
                    setProjects(prevProjects =>
                        prevProjects.map(project =>
                            project.id === renameModal.project.id
                                ? { ...project, name: newName }
                                : project
                        )
                    );
                }
                setRenameModal({ isOpen: false, project: null });
            };

            const handleDeleteProject = () => {
                if (deleteModal.project) {
                    setProjects(prevProjects =>
                        prevProjects.filter(project => project.id !== deleteModal.project.id)
                    );
                }
                setDeleteModal({ isOpen: false, project: null });
            };

            // Set initial theme on component mount
            React.useEffect(() => {
                document.body.className = `theme-${currentTheme}`;
            }, []);

            // Handle window resize to reposition tiles to new grid
            React.useEffect(() => {
                const handleResize = () => {
                    setProjects(prevProjects => 
                        prevProjects.map(project => {
                            const snappedPosition = snapToGrid(project.x, project.y);
                            return { ...project, ...snappedPosition };
                        })
                    );
                };

                window.addEventListener('resize', handleResize);
                return () => window.removeEventListener('resize', handleResize);
            }, []);

            // Calculate position for new project tile (next available grid position)
            const getNewProjectTilePosition = () => {
                const cols = Math.floor((window.innerWidth - 2 * MARGIN) / GRID_SIZE);
                
                if (projects.length === 0) {
                    // If no projects, place at first grid position
                    return {
                        x: MARGIN,
                        y: MARGIN
                    };
                }
                
                // Find the rightmost and bottommost occupied positions
                let maxRow = 0;
                let maxColInBottomRow = -1;
                
                projects.forEach(project => {
                    const col = Math.round((project.x - MARGIN) / GRID_SIZE);
                    const row = Math.round((project.y - MARGIN) / GRID_SIZE);
                    
                    if (row > maxRow) {
                        maxRow = row;
                        maxColInBottomRow = col;
                    } else if (row === maxRow && col > maxColInBottomRow) {
                        maxColInBottomRow = col;
                    }
                });
                
                // Calculate next position
                let nextCol = maxColInBottomRow + 1;
                let nextRow = maxRow;
                
                // If we exceed the number of columns, wrap to next row
                if (nextCol >= cols) {
                    nextCol = 0;
                    nextRow = maxRow + 1;
                }
                
                return {
                    x: MARGIN + nextCol * GRID_SIZE,
                    y: MARGIN + nextRow * GRID_SIZE
                };
            };

            return (
                <>
                    <ThemeSelector 
                        currentTheme={currentTheme} 
                        onThemeChange={handleThemeChange} 
                    />
                    <div className="dashboard-container">
                        {projects.map(project => (
                            <ProjectTile 
                                key={project.id} 
                                project={project}
                                onDragStart={handleDragStart}
                                onDrag={handleDrag}
                                onDragEnd={handleDragEnd}
                                isDragging={draggedItemId === project.id}
                                onSelect={onProjectSelect}
                                onContextMenu={handleContextMenu}
                            />
                        ))}
                        <NewProjectTile 
                            onCreateNew={onOpenModal}
                            position={getNewProjectTilePosition()}
                        />
                    </div>
                    
                    <ContextMenu
                        isOpen={contextMenu.isOpen}
                        position={contextMenu.position}
                        onClose={handleCloseContextMenu}
                        onRename={handleRename}
                        onDelete={handleDelete}
                    />
                    
                    <RenameModal
                        isOpen={renameModal.isOpen}
                        onClose={() => setRenameModal({ isOpen: false, project: null })}
                        onRename={handleRenameProject}
                        currentName={renameModal.project?.name || ''}
                    />
                    
                    <DeleteConfirmModal
                        isOpen={deleteModal.isOpen}
                        onClose={() => setDeleteModal({ isOpen: false, project: null })}
                        onDelete={handleDeleteProject}
                        projectName={deleteModal.project?.name || ''}
                    />
                </>
            );
        }

        function App() {
            const [selectedProject, setSelectedProject] = useState(null);
            const [isModalOpen, setIsModalOpen] = useState(false);

            // Grid configuration
            const GRID_SIZE = 180; // 150px tile + 30px spacing
            const MARGIN = 30; // Margin from screen edges

            // Load projects from localStorage on initial render
            const [projects, setProjects] = useState(() => {
                return loadProjectsFromLocalStorage();
            });

            // Save projects to localStorage whenever projects state changes
            useEffect(() => {
                saveProjectsToLocalStorage(projects);
            }, [projects]);

            const handleProjectSelect = (project) => {
                setSelectedProject(project);
            };

            const handleGoBack = () => {
                setSelectedProject(null);
            };

            const handleOpenModal = () => {
                setIsModalOpen(true);
            };

            const handleCloseModal = () => {
                setIsModalOpen(false);
            };

            const handleCreateProject = (projectName) => {
                // Generate unique ID
                const newId = Math.max(...projects.map(p => p.id)) + 1;
                
                // Calculate position for new project
                const cols = Math.floor((window.innerWidth - 2 * MARGIN) / GRID_SIZE);
                const currentProjectCount = projects.length;
                const col = currentProjectCount % cols;
                const row = Math.floor(currentProjectCount / cols);
                const position = {
                    x: MARGIN + col * GRID_SIZE,
                    y: MARGIN + row * GRID_SIZE
                };
                
                // Add new project to the list with setup flag
                const newProject = {
                    id: newId,
                    name: projectName,
                    isSetupComplete: false,
                    ...position
                };
                
                setProjects(prevProjects => [...prevProjects, newProject]);
                setIsModalOpen(false);
            };

            const handleCompleteSetup = (projectId, setupData) => {
                setProjects(prevProjects =>
                    prevProjects.map(project =>
                        project.id === projectId
                            ? {
                                ...project,
                                isSetupComplete: true,
                                oneSentencePitch: setupData.oneSentencePitch,
                                problemStatement: setupData.problemStatement,
                                targetAudience: setupData.targetAudience,
                                uniqueSolution: setupData.uniqueSolution
                            }
                            : project
                    )
                );
            };

            return (
                <>
                    {selectedProject ? (
                        selectedProject.isSetupComplete ? (
                            <ProjectView 
                                project={selectedProject} 
                                onGoBack={handleGoBack} 
                            />
                        ) : (
                            <ProjectCoreWizard 
                                project={selectedProject}
                                onGoBack={handleGoBack}
                                onCompleteSetup={handleCompleteSetup}
                            />
                        )
                    ) : (
                        <Dashboard 
                            onProjectSelect={handleProjectSelect} 
                            onOpenModal={handleOpenModal}
                            projects={projects}
                            setProjects={setProjects}
                        />
                    )}
                    <ProjectModal 
                        isOpen={isModalOpen}
                        onClose={handleCloseModal}
                        onCreateProject={handleCreateProject}
                    />
                </>
            );
        }

        // Render the App component
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
